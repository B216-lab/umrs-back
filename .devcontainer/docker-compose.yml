version: '3.9'

services:
    app:
        build:
            context: ..
            dockerfile: .devcontainer/Dockerfile
        volumes:
            - ..:/workspace:cached
            - gradle-cache:/home/vscode/.gradle
        command: sleep infinity
        working_dir: /workspace
        environment:
            - LOGGING_FILE_PATH=/workspace/logs
        ports:
            - '8080:8080'
        depends_on:
            - postgres

    postgres:
        image: 'postgis/postgis:18-3.6-alpine'
        environment:
            - 'POSTGRES_DB=mydatabase'
            - 'POSTGRES_PASSWORD=secret'
            - 'POSTGRES_USER=myuser'
        ports:
            - '32779:5432'
        volumes:
            - postgres-data:/var/lib/postgresql/data

volumes:
    gradle-cache:
    postgres-data:

